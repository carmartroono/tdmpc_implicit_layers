Logs will be synced with wandb.
Architecture: TD-MPC2 World Model
Encoder: ModuleDict(
  (state): DEQ_MLP(
    (act): GELU(approximate='none')
    (input_proj): Sequential(
      (0): Linear(in_features=17, out_features=256, bias=True)
      (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
      (2): GELU(approximate='none')
    )
    (deq_func): ImprovedDEQFunc(
      (layers): Sequential(
        (0): Linear(in_features=256, out_features=256, bias=True)
        (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (2): GELU(approximate='none')
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=256, out_features=256, bias=True)
        (5): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (6): GELU(approximate='none')
        (7): Dropout(p=0.1, inplace=False)
        (8): Linear(in_features=256, out_features=256, bias=True)
        (9): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (10): GELU(approximate='none')
      )
    )
    (output_proj): Sequential(
      (0): Linear(in_features=256, out_features=512, bias=True)
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    )
    (skip_proj): Linear(in_features=17, out_features=512, bias=True)
    (deq): DEQSliced()
  )
)
Dynamics: Sequential(
  (0): NormedLinear(in_features=518, out_features=512, bias=True, act=Mish)
  (1): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (2): NormedLinear(in_features=512, out_features=512, bias=True, act=SimNorm)
)
Reward: Sequential(
  (0): NormedLinear(in_features=518, out_features=512, bias=True, act=Mish)
  (1): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (2): Linear(in_features=512, out_features=101, bias=True)
)
Policy prior: Sequential(
  (0): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (1): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (2): Linear(in_features=512, out_features=12, bias=True)
)
Q-functions: Vectorized 5x Sequential(
  (0): NormedLinear(in_features=518, out_features=512, bias=True, dropout=0.01, act=Mish)
  (1): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (2): Linear(in_features=512, out_features=101, bias=True)
)
Learnable parameters: 5,166,955
 eval             E: 0                     I: 0                     R: 3.2                   S: 0.0                   T: 0:10:07
 train            E: 0                     I: 500                   R: 9.0                   S: 0.0                   T: 0:10:07
Buffer capacity: 100,000
Storage required: 0.01 GB
Using CUDA:0 memory for storage.
 train            E: 1                     I: 1,000                 R: 5.2                   S: 0.0                   T: 0:10:07
 train            E: 2                     I: 1,500                 R: 3.2                   S: 0.0                   T: 0:10:08
 train            E: 3                     I: 2,000                 R: 4.2                   S: 0.0                   T: 0:10:08
 train            E: 4                     I: 2,500                 R: 3.8                   S: 0.0                   T: 0:10:08
Pretraining agent on seed data...
 train            E: 5                     I: 3,000                 R: 9.0                   S: 0.0                   T: 0:22:37
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/train.py", line 69, in <module>
    train()
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
        ^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/train.py", line 64, in train
    trainer.train()
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/trainer/online_trainer.py", line 122, in train
    _train_metrics = self.agent.update(self.buffer)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/tdmpc2.py", line 350, in update
    return self._update(obs, action, reward, terminated, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/tdmpc2.py", line 264, in _update
    next_z = self.model.encode(obs[1:], task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/common/world_model.py", line 113, in encode
    return self._encoder[self.cfg.obs](obs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 929, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/common/layers.py", line 438, in forward
    z_star, info = self.deq(self.deq_func, z0)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/torchdeq/core.py", line 613, in forward
    z_star, info = self._solve_fixed_point(deq_func, z_star,
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/torchdeq/core.py", line 553, in _solve_fixed_point
    z_star, _, info = self.f_solver(
                      ^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/torchdeq/solver/anderson.py", line 85, in anderson_solver
    alpha = torch.linalg.solve(H[:,:n+1,:n+1], y[:,:n+1])[:, 1:n+1, 0]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch._C._LinAlgError: torch.linalg.solve: (Batch element 1): The solver failed because the input matrix is singular.
