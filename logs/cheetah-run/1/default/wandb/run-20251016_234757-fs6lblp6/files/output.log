Logs will be synced with wandb.
Architecture: TD-MPC2 World Model
Encoder: ModuleDict(
  (state): DEQ_MLP(
    (act): GELU(approximate='none')
    (input_proj): Sequential(
      (0): Linear(in_features=17, out_features=256, bias=True)
      (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
      (2): GELU(approximate='none')
    )
    (deq_func): ImprovedDEQFunc(
      (layers): Sequential(
        (0): Linear(in_features=256, out_features=256, bias=True)
        (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (2): GELU(approximate='none')
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=256, out_features=256, bias=True)
        (5): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (6): GELU(approximate='none')
        (7): Dropout(p=0.1, inplace=False)
        (8): Linear(in_features=256, out_features=256, bias=True)
        (9): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (10): GELU(approximate='none')
      )
    )
    (output_proj): Sequential(
      (0): Linear(in_features=256, out_features=512, bias=True)
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    )
    (skip_proj): Linear(in_features=17, out_features=512, bias=True)
    (deq): DEQSliced()
  )
)
Dynamics: Sequential(
  (0): NormedLinear(in_features=518, out_features=512, bias=True, act=Mish)
  (1): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (2): NormedLinear(in_features=512, out_features=512, bias=True, act=SimNorm)
)
Reward: Sequential(
  (0): NormedLinear(in_features=518, out_features=512, bias=True, act=Mish)
  (1): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (2): Linear(in_features=512, out_features=101, bias=True)
)
Policy prior: Sequential(
  (0): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (1): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (2): Linear(in_features=512, out_features=12, bias=True)
)
Q-functions: Vectorized 5x Sequential(
  (0): NormedLinear(in_features=518, out_features=512, bias=True, dropout=0.01, act=Mish)
  (1): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (2): Linear(in_features=512, out_features=101, bias=True)
)
Learnable parameters: 5,166,955
 eval             E: 0                     I: 0                     R: 2.7                   S: 0.0                   T: 0:09:59
 train            E: 0                     I: 500                   R: 3.1                   S: 0.0                   T: 0:10:00
Buffer capacity: 100,000
Storage required: 0.01 GB
Using CUDA:0 memory for storage.
 train            E: 1                     I: 1,000                 R: 7.6                   S: 0.0                   T: 0:10:00
 train            E: 2                     I: 1,500                 R: 4.3                   S: 0.0                   T: 0:10:00
 train            E: 3                     I: 2,000                 R: 4.9                   S: 0.0                   T: 0:10:00
 train            E: 4                     I: 2,500                 R: 7.6                   S: 0.0                   T: 0:10:00
Pretraining agent on seed data...
 train            E: 5                     I: 3,000                 R: 14.4                  S: 0.0                   T: 0:22:28
 train            E: 6                     I: 3,500                 R: 30.7                  S: 0.0                   T: 0:25:23
 train            E: 7                     I: 4,000                 R: 38.4                  S: 0.0                   T: 0:28:15
 train            E: 8                     I: 4,500                 R: 36.0                  S: 0.0                   T: 0:31:07
 train            E: 9                     I: 5,000                 R: 66.0                  S: 0.0                   T: 0:33:59
 train            E: 10                    I: 5,500                 R: 53.7                  S: 0.0                   T: 0:36:50
 train            E: 11                    I: 6,000                 R: 59.3                  S: 0.0                   T: 0:39:41
 train            E: 12                    I: 6,500                 R: 73.0                  S: 0.0                   T: 0:42:32
 train            E: 13                    I: 7,000                 R: 73.3                  S: 0.0                   T: 0:45:24
 train            E: 14                    I: 7,500                 R: 67.2                  S: 0.0                   T: 0:48:16
 train            E: 15                    I: 8,000                 R: 85.2                  S: 0.0                   T: 0:51:08
 train            E: 16                    I: 8,500                 R: 81.5                  S: 0.0                   T: 0:53:59
 train            E: 17                    I: 9,000                 R: 88.1                  S: 0.0                   T: 0:56:51
 train            E: 18                    I: 9,500                 R: 110.4                 S: 0.0                   T: 0:59:42
 train            E: 19                    I: 10,000                R: 118.1                 S: 0.0                   T: 1:02:34
 train            E: 20                    I: 10,500                R: 138.6                 S: 0.0                   T: 1:05:25
 train            E: 21                    I: 11,000                R: 127.9                 S: 0.0                   T: 1:08:17
 train            E: 22                    I: 11,500                R: 84.0                  S: 0.0                   T: 1:11:08
 train            E: 23                    I: 12,000                R: 154.4                 S: 0.0                   T: 1:14:00
 train            E: 24                    I: 12,500                R: 165.2                 S: 0.0                   T: 1:16:52
 train            E: 25                    I: 13,000                R: 144.8                 S: 0.0                   T: 1:19:44
 train            E: 26                    I: 13,500                R: 168.0                 S: 0.0                   T: 1:22:35
 train            E: 27                    I: 14,000                R: 142.9                 S: 0.0                   T: 1:25:27
 train            E: 28                    I: 14,500                R: 66.8                  S: 0.0                   T: 1:28:19
 train            E: 29                    I: 15,000                R: 135.5                 S: 0.0                   T: 1:31:10
 train            E: 30                    I: 15,500                R: 119.5                 S: 0.0                   T: 1:34:02
 train            E: 31                    I: 16,000                R: 166.9                 S: 0.0                   T: 1:36:53
 train            E: 32                    I: 16,500                R: 62.7                  S: 0.0                   T: 1:39:45
 train            E: 33                    I: 17,000                R: 119.3                 S: 0.0                   T: 1:42:37
 train            E: 34                    I: 17,500                R: 183.3                 S: 0.0                   T: 1:45:29
 train            E: 35                    I: 18,000                R: 158.0                 S: 0.0                   T: 1:48:21
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/train.py", line 69, in <module>
    train()
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
        ^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/train.py", line 64, in train
    trainer.train()
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/trainer/online_trainer.py", line 122, in train
    _train_metrics = self.agent.update(self.buffer)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/tdmpc2.py", line 350, in update
    return self._update(obs, action, reward, terminated, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/tdmpc2.py", line 264, in _update
    next_z = self.model.encode(obs[1:], task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/common/world_model.py", line 113, in encode
    return self._encoder[self.cfg.obs](obs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 929, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/common/layers.py", line 438, in forward
    z_star, info = self.deq(self.deq_func, z0)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/torchdeq/core.py", line 613, in forward
    z_star, info = self._solve_fixed_point(deq_func, z_star,
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/torchdeq/core.py", line 553, in _solve_fixed_point
    z_star, _, info = self.f_solver(
                      ^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/torchdeq/solver/anderson.py", line 85, in anderson_solver
    alpha = torch.linalg.solve(H[:,:n+1,:n+1], y[:,:n+1])[:, 1:n+1, 0]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch._C._LinAlgError: torch.linalg.solve: (Batch element 0): The solver failed because the input matrix is singular.
