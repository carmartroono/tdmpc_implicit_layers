Logs will be synced with wandb.
Architecture: TD-MPC2 World Model
Encoder: ModuleDict(
  (state): DEQ_MLP(
    (act): GELU(approximate='none')
    (input_proj): Sequential(
      (0): Linear(in_features=17, out_features=256, bias=True)
      (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
      (2): GELU(approximate='none')
    )
    (deq_func): ImprovedDEQFunc(
      (layers): Sequential(
        (0): Linear(in_features=256, out_features=256, bias=True)
        (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (2): GELU(approximate='none')
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=256, out_features=256, bias=True)
        (5): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (6): GELU(approximate='none')
        (7): Dropout(p=0.1, inplace=False)
        (8): Linear(in_features=256, out_features=256, bias=True)
        (9): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        (10): GELU(approximate='none')
      )
    )
    (output_proj): Sequential(
      (0): Linear(in_features=256, out_features=512, bias=True)
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    )
    (skip_proj): Linear(in_features=17, out_features=512, bias=True)
    (deq): DEQSliced()
  )
)
Dynamics: Sequential(
  (0): NormedLinear(in_features=518, out_features=512, bias=True, act=Mish)
  (1): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (2): NormedLinear(in_features=512, out_features=512, bias=True, act=SimNorm)
)
Reward: Sequential(
  (0): NormedLinear(in_features=518, out_features=512, bias=True, act=Mish)
  (1): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (2): Linear(in_features=512, out_features=101, bias=True)
)
Policy prior: Sequential(
  (0): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (1): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (2): Linear(in_features=512, out_features=12, bias=True)
)
Q-functions: Vectorized 5x Sequential(
  (0): NormedLinear(in_features=518, out_features=512, bias=True, dropout=0.01, act=Mish)
  (1): NormedLinear(in_features=512, out_features=512, bias=True, act=Mish)
  (2): Linear(in_features=512, out_features=101, bias=True)
)
Learnable parameters: 5,166,955
 eval             E: 0                     I: 0                     R: 2.7                   S: 0.0                   T: 0:10:03
 train            E: 0                     I: 500                   R: 7.9                   S: 0.0                   T: 0:10:03
Buffer capacity: 100,000
Storage required: 0.01 GB
Using CUDA:0 memory for storage.
 train            E: 1                     I: 1,000                 R: 9.2                   S: 0.0                   T: 0:10:03
 train            E: 2                     I: 1,500                 R: 10.1                  S: 0.0                   T: 0:10:03
 train            E: 3                     I: 2,000                 R: 8.2                   S: 0.0                   T: 0:10:03
 train            E: 4                     I: 2,500                 R: 5.1                   S: 0.0                   T: 0:10:03
Pretraining agent on seed data...
 train            E: 5                     I: 3,000                 R: 23.7                  S: 0.0                   T: 0:22:35
 train            E: 6                     I: 3,500                 R: 32.0                  S: 0.0                   T: 0:25:53
 train            E: 7                     I: 4,000                 R: 18.0                  S: 0.0                   T: 0:28:49
 train            E: 8                     I: 4,500                 R: 64.6                  S: 0.0                   T: 0:31:48
 train            E: 9                     I: 5,000                 R: 49.9                  S: 0.0                   T: 0:34:47
 train            E: 10                    I: 5,500                 R: 34.6                  S: 0.0                   T: 0:37:49
 train            E: 11                    I: 6,000                 R: 47.9                  S: 0.0                   T: 0:41:13
 train            E: 12                    I: 6,500                 R: 74.5                  S: 0.0                   T: 0:44:20
 train            E: 13                    I: 7,000                 R: 79.6                  S: 0.0                   T: 0:47:42
 train            E: 14                    I: 7,500                 R: 86.7                  S: 0.0                   T: 0:51:10
 train            E: 15                    I: 8,000                 R: 102.2                 S: 0.0                   T: 0:54:05
 train            E: 16                    I: 8,500                 R: 122.0                 S: 0.0                   T: 0:57:00
 train            E: 17                    I: 9,000                 R: 135.4                 S: 0.0                   T: 1:00:09
 train            E: 18                    I: 9,500                 R: 118.6                 S: 0.0                   T: 1:03:04
 train            E: 19                    I: 10,000                R: 138.1                 S: 0.0                   T: 1:05:57
 train            E: 20                    I: 10,500                R: 113.9                 S: 0.0                   T: 1:08:49
 train            E: 21                    I: 11,000                R: 133.5                 S: 0.0                   T: 1:11:41
 train            E: 22                    I: 11,500                R: 115.5                 S: 0.0                   T: 1:14:34
 train            E: 23                    I: 12,000                R: 140.4                 S: 0.0                   T: 1:17:25
 train            E: 24                    I: 12,500                R: 48.8                  S: 0.0                   T: 1:20:18
 train            E: 25                    I: 13,000                R: 123.9                 S: 0.0                   T: 1:23:10
 train            E: 26                    I: 13,500                R: 146.5                 S: 0.0                   T: 1:26:01
 train            E: 27                    I: 14,000                R: 157.1                 S: 0.0                   T: 1:28:52
 train            E: 28                    I: 14,500                R: 118.6                 S: 0.0                   T: 1:31:44
 train            E: 29                    I: 15,000                R: 151.6                 S: 0.0                   T: 1:34:37
 train            E: 30                    I: 15,500                R: 113.9                 S: 0.0                   T: 1:37:38
Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/train.py", line 69, in <module>
    train()
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
        ^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/train.py", line 64, in train
    trainer.train()
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/trainer/online_trainer.py", line 122, in train
    _train_metrics = self.agent.update(self.buffer)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/tdmpc2.py", line 350, in update
    return self._update(obs, action, reward, terminated, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/tdmpc2.py", line 264, in _update
    next_z = self.model.encode(obs[1:], task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/common/world_model.py", line 113, in encode
    return self._encoder[self.cfg.obs](obs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 929, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/tdmpc2-main/tdmpc2/common/layers.py", line 444, in forward
    z_star, info = self.deq(self.deq_func, z0)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib64/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/torchdeq/core.py", line 613, in forward
    z_star, info = self._solve_fixed_point(deq_func, z_star,
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/torchdeq/core.py", line 553, in _solve_fixed_point
    z_star, _, info = self.f_solver(
                      ^^^^^^^^^^^^^^
  File "/home/lug15gew/Desktop/thesis/.venv/lib/python3.12/site-packages/torchdeq/solver/anderson.py", line 85, in anderson_solver
    alpha = torch.linalg.solve(H[:,:n+1,:n+1], y[:,:n+1])[:, 1:n+1, 0]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch._C._LinAlgError: torch.linalg.solve: (Batch element 0): The solver failed because the input matrix is singular.
